# Authing - ç»Ÿä¸€èº«ä»½è®¤è¯å¹³å°

<div align="center">

**ä¼ä¸šçº§ç»Ÿä¸€èº«ä»½è®¤è¯ä¸æƒé™ç®¡ç†ç³»ç»Ÿ**

[![Python](https://img.shields.io/badge/Python-3.13+-blue.svg)](https://www.python.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.115+-green.svg)](https://fastapi.tiangolo.com/)
[![React](https://img.shields.io/badge/React-19.1+-61DAFB.svg)](https://reactjs.org/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

</div>

## ğŸ“– é¡¹ç›®ç®€ä»‹

Authing æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ç»Ÿä¸€èº«ä»½è®¤è¯ä¸æƒé™ç®¡ç†å¹³å°ï¼Œæä¾›å®Œæ•´çš„ç”¨æˆ·è®¤è¯ã€æˆæƒå’Œç®¡ç†è§£å†³æ–¹æ¡ˆã€‚åŸºäº FastAPI + React æ„å»ºï¼Œæ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼Œé€‚ç”¨äºä¼ä¸šçº§åº”ç”¨çš„èº«ä»½è®¤è¯éœ€æ±‚ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ” **å¤šç§è®¤è¯æ–¹å¼**
  - ç”¨æˆ·å/å¯†ç ç™»å½•
  - æ‰‹æœºå· OTP éªŒè¯ç ç™»å½•
  - é‚®ç®± OTP éªŒè¯ç ç™»å½•
  - äºŒç»´ç æ‰«ç ç™»å½•
  
- ğŸ‘¥ **ç”¨æˆ·ç®¡ç†**
  - ç”¨æˆ·æ³¨å†Œä¸æ¿€æ´»
  - ç”¨æˆ·ä¿¡æ¯ç®¡ç†
  - ç”¨æˆ·çŠ¶æ€æ§åˆ¶ï¼ˆæ¿€æ´»/å†»ç»“/å¾…å®¡æ ¸ï¼‰
  - æ‰©å±•ç”¨æˆ·å±æ€§æ”¯æŒ
  
- ğŸ­ **RBAC æƒé™ç®¡ç†**
  - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
  - çµæ´»çš„è§’è‰²-æƒé™ç»‘å®š
  - ç”¨æˆ·-è§’è‰²å…³è”ç®¡ç†
  - æƒé™è¿‡æœŸæ—¶é—´æ§åˆ¶
  
- ğŸ¢ **å¤šç§Ÿæˆ·æ”¯æŒ**
  - ç”¨æˆ·æ± éš”ç¦»
  - åº”ç”¨ç®¡ç†
  - ç‹¬ç«‹é…ç½®
  
- ğŸ”’ **å®‰å…¨ç‰¹æ€§**
  - JWT Token è®¤è¯
  - Refresh Token åˆ·æ–°æœºåˆ¶
  - å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆbcryptï¼‰
  - API é™æµä¿æŠ¤
  - å®‰å…¨å¤´éƒ¨é…ç½®
  - å®¡è®¡æ—¥å¿—è®°å½•
  
- ğŸ“Š **ç›‘æ§ä¸æ—¥å¿—**
  - ç»“æ„åŒ–æ—¥å¿—ï¼ˆstructlogï¼‰
  - å¥åº·æ£€æŸ¥ç«¯ç‚¹
  - å®¡è®¡æ—¥å¿—è¿½è¸ª
  - è¯·æ±‚æ—¥å¿—è®°å½•

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: FastAPI 0.115+
- **æ•°æ®åº“**: SQLite / PostgreSQL / MySQLï¼ˆå¯é€‰ï¼‰
- **ORM**: SQLModel + SQLAlchemy 2.0
- **è®¤è¯**: JWT (python-jose)
- **å¯†ç åŠ å¯†**: Bcrypt
- **æ•°æ®éªŒè¯**: Pydantic 2.0
- **æ—¥å¿—**: Structlog + Loguru
- **ç¼“å­˜**: Redisï¼ˆå¯é€‰ï¼‰
- **ä»»åŠ¡é˜Ÿåˆ—**: Celeryï¼ˆå¯é€‰ï¼‰
- **æ•°æ®åº“è¿ç§»**: Alembic

### å‰ç«¯æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: React 19.1
- **æ„å»ºå·¥å…·**: Vite 7.1
- **è¯­è¨€**: TypeScript 5.8
- **è·¯ç”±**: React Router 7.8
- **çŠ¶æ€ç®¡ç†**: Zustand 5.0
- **æ•°æ®è¯·æ±‚**: TanStack Query 5.87
- **UI ç»„ä»¶**: Radix UI
- **æ ·å¼**: TailwindCSS 4.1
- **è¡¨å•**: React Hook Form + Zod
- **å›¾æ ‡**: Lucide React

## ğŸ“ é¡¹ç›®ç»“æ„

```
Authing/
â”œâ”€â”€ app/                          # åç«¯åº”ç”¨
â”‚   â”œâ”€â”€ api/                      # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ deps.py              # ä¾èµ–æ³¨å…¥
â”‚   â”‚   â””â”€â”€ v1/                  # API v1 ç‰ˆæœ¬
â”‚   â”‚       â”œâ”€â”€ auth.py          # è®¤è¯ç›¸å…³æ¥å£
â”‚   â”‚       â”œâ”€â”€ users.py         # ç”¨æˆ·ç®¡ç†æ¥å£
â”‚   â”‚       â”œâ”€â”€ rbac.py          # æƒé™ç®¡ç†æ¥å£
â”‚   â”‚       â””â”€â”€ router.py        # è·¯ç”±æ±‡æ€»
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ middleware.py        # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ exceptions.py        # å¼‚å¸¸å®šä¹‰
â”‚   â”‚   â””â”€â”€ security.py          # å®‰å…¨ç›¸å…³
â”‚   â”œâ”€â”€ models/                  # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.py             # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ auth.py             # è®¤è¯æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ rbac.py             # æƒé™æ¨¡å‹
â”‚   â”‚   â””â”€â”€ base.py             # åŸºç¡€æ¨¡å‹
â”‚   â”œâ”€â”€ schemas/                 # Pydantic æ¨¡å¼
â”‚   â”œâ”€â”€ services/                # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ db/                      # æ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ config.py               # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ main.py                 # åº”ç”¨å…¥å£
â”œâ”€â”€ frontend/                    # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/         # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/           # è®¤è¯é¡µé¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ login.tsx   # ç™»å½•é¡µ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ register.tsx # æ³¨å†Œé¡µ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ otp-login.tsx # OTPç™»å½•
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ qr-login.tsx  # æ‰«ç ç™»å½•
â”‚   â”‚   â”‚   â””â”€â”€ Dashboard.tsx   # ä»ªè¡¨ç›˜
â”‚   â”‚   â”œâ”€â”€ services/           # API æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ stores/             # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ types/              # TypeScript ç±»å‹
â”‚   â””â”€â”€ Dockerfile              # å‰ç«¯å®¹å™¨é…ç½®
â”œâ”€â”€ tests/                       # æµ‹è¯•ç”¨ä¾‹
â”‚   â”œâ”€â”€ test_auth.py            # è®¤è¯æµ‹è¯•
â”‚   â”œâ”€â”€ test_users.py           # ç”¨æˆ·æµ‹è¯•
â”‚   â”œâ”€â”€ test_rbac.py            # æƒé™æµ‹è¯•
â”‚   â””â”€â”€ conftest.py             # æµ‹è¯•é…ç½®
â”œâ”€â”€ alembic/                     # æ•°æ®åº“è¿ç§»
â”œâ”€â”€ nginx/                       # Nginx é…ç½®
â”œâ”€â”€ logs/                        # æ—¥å¿—ç›®å½•
â”œâ”€â”€ data/                        # æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ Dockerfile                   # åç«¯å®¹å™¨é…ç½®
â”œâ”€â”€ docker-compose.yml          # Docker ç¼–æ’
â”œâ”€â”€ deploy.sh                   # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ pyproject.toml              # Python ä¾èµ–
â””â”€â”€ .env.example                # ç¯å¢ƒå˜é‡æ¨¡æ¿
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.13+
- Node.js 18+
- pnpm 8+
- Docker 20.10+ (å¯é€‰)
- Docker Compose 2.0+ (å¯é€‰)

### æœ¬åœ°å¼€å‘

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone <your-repo-url>
cd Authing
```

#### 2. åç«¯è®¾ç½®

```bash
# å®‰è£… Poetry
curl -sSL https://install.python-poetry.org | python3 -

# å®‰è£…ä¾èµ–
poetry install

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®å¿…è¦çš„å‚æ•°

# è¿è¡Œæ•°æ®åº“è¿ç§»
poetry run alembic upgrade head

# å¯åŠ¨åç«¯æœåŠ¡
poetry run uvicorn app.main:app --reload --host 0.0.0.0 --port 7000
```

#### 3. å‰ç«¯è®¾ç½®

```bash
cd frontend

# å®‰è£…ä¾èµ–
pnpm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev
```

#### 4. è®¿é—®åº”ç”¨

- å‰ç«¯åº”ç”¨: http://localhost:5173
- åç«¯ API: http://localhost:7000
- API æ–‡æ¡£: http://localhost:7000/docs

### Docker éƒ¨ç½²

è¯¦ç»†çš„ Docker éƒ¨ç½²æŒ‡å—è¯·å‚è€ƒ [DEPLOYMENT.md](DEPLOYMENT.md)

#### å¿«é€Ÿéƒ¨ç½²

```bash
# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env

# å¼€å‘ç¯å¢ƒéƒ¨ç½²
./deploy.sh dev

# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
./deploy.sh prod
```

#### è®¿é—®åœ°å€

- **å¼€å‘ç¯å¢ƒ**
  - å‰ç«¯: http://localhost:7001
  - åç«¯: http://localhost:7000
  - API æ–‡æ¡£: http://localhost:7000/docs

- **ç”Ÿäº§ç¯å¢ƒ**
  - åº”ç”¨å…¥å£: http://localhost:7002
  - HTTPS: https://localhost:7003

## ğŸ“š æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

### 1. ç”¨æˆ·è®¤è¯

#### å¯†ç ç™»å½•
```bash
POST /api/v1/auth/login
Content-Type: application/json

{
  "username": "user@example.com",
  "password": "password123"
}
```

#### OTP éªŒè¯ç ç™»å½•
```bash
# å‘é€éªŒè¯ç 
POST /api/v1/auth/otp/send
{
  "identifier": "13800138000",
  "type": "login"
}

# éªŒè¯ç™»å½•
POST /api/v1/auth/otp/verify
{
  "identifier": "13800138000",
  "code": "123456"
}
```

#### äºŒç»´ç ç™»å½•
```bash
# ç”ŸæˆäºŒç»´ç 
POST /api/v1/auth/qr/generate

# æ‰«ç ç¡®è®¤
POST /api/v1/auth/qr/confirm
{
  "scene_id": "uuid-string"
}

# è½®è¯¢çŠ¶æ€
GET /api/v1/auth/qr/poll/{scene_id}
```

### 2. ç”¨æˆ·ç®¡ç†

- ç”¨æˆ·æ³¨å†Œ
- ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ä¸æ›´æ–°
- ç”¨æˆ·çŠ¶æ€ç®¡ç†
- ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢ï¼ˆæ”¯æŒåˆ†é¡µã€ç­›é€‰ï¼‰

### 3. RBAC æƒé™ç®¡ç†

- è§’è‰²åˆ›å»ºä¸ç®¡ç†
- æƒé™å®šä¹‰ä¸åˆ†é…
- ç”¨æˆ·è§’è‰²ç»‘å®š
- æƒé™éªŒè¯ä¸æ£€æŸ¥

### 4. å®¡è®¡æ—¥å¿—

æ‰€æœ‰å…³é”®æ“ä½œéƒ½ä¼šè®°å½•å®¡è®¡æ—¥å¿—ï¼ŒåŒ…æ‹¬ï¼š
- ç”¨æˆ·ç™»å½•/ç™»å‡º
- ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹
- è§’è‰²æƒé™å˜æ›´
- æ•æ„Ÿæ“ä½œè®°å½•

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

å…³é”®é…ç½®é¡¹è¯´æ˜ï¼š

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | å¿…å¡« |
|--------|------|--------|------|
| `JWT_SECRET_KEY` | JWT ç­¾åå¯†é’¥ | - | âœ… |
| `SECRET_KEY` | åº”ç”¨å¯†é’¥ | - | âœ… |
| `DATABASE_URL` | æ•°æ®åº“è¿æ¥ | sqlite:///app/data/authing.db | âŒ |
| `REDIS_URL` | Redis è¿æ¥ | - | âŒ |
| `SMTP_HOST` | é‚®ä»¶æœåŠ¡å™¨ | - | âŒ |
| `CORS_ORIGINS` | CORS å…è®¸æº | http://localhost:3000 | âŒ |

å®Œæ•´é…ç½®è¯·å‚è€ƒ `.env.example` æ–‡ä»¶ã€‚

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
poetry run pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•
poetry run pytest tests/test_auth.py

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
poetry run pytest --cov=app --cov-report=html
```

### æµ‹è¯•è¦†ç›–

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹ï¼š
- è®¤è¯æµç¨‹æµ‹è¯•
- ç”¨æˆ·ç®¡ç†æµ‹è¯•
- RBAC æƒé™æµ‹è¯•
- é›†æˆæµ‹è¯•

## ğŸ“Š API æ–‡æ¡£

å¯åŠ¨åç«¯æœåŠ¡åï¼Œè®¿é—®ä»¥ä¸‹åœ°å€æŸ¥çœ‹ API æ–‡æ¡£ï¼š

- **Swagger UI**: http://localhost:7000/docs
- **ReDoc**: http://localhost:7000/redoc

## ğŸ” å®‰å…¨å»ºè®®

1. **ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹**:
   - `JWT_SECRET_KEY`
   - `SECRET_KEY`
   - æ•°æ®åº“å¯†ç 

2. **å¯ç”¨ HTTPS**:
   - é…ç½® SSL è¯ä¹¦
   - ä½¿ç”¨åå‘ä»£ç†ï¼ˆNginxï¼‰

3. **æ•°æ®åº“å®‰å…¨**:
   - ä½¿ç”¨å¼ºå¯†ç 
   - é™åˆ¶è®¿é—®æƒé™
   - å®šæœŸå¤‡ä»½

4. **é™æµé…ç½®**:
   - è°ƒæ•´ API é™æµå‚æ•°
   - é˜²æ­¢æš´åŠ›ç ´è§£

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

1. **ä½¿ç”¨å¤–éƒ¨æ•°æ®åº“**: ç”Ÿäº§ç¯å¢ƒæ¨è PostgreSQL
2. **å¯ç”¨ Redis ç¼“å­˜**: æå‡æ€§èƒ½
3. **CDN åŠ é€Ÿ**: é™æ€èµ„æºä½¿ç”¨ CDN
4. **è´Ÿè½½å‡è¡¡**: å¤šå®ä¾‹éƒ¨ç½²

## ğŸ› ï¸ å¼€å‘å·¥å…·

### ä»£ç æ ¼å¼åŒ–

```bash
# Python ä»£ç æ ¼å¼åŒ–
poetry run black app/
poetry run isort app/

# ä»£ç æ£€æŸ¥
poetry run flake8 app/
poetry run mypy app/
```

### æ•°æ®åº“è¿ç§»

```bash
# åˆ›å»ºè¿ç§»
poetry run alembic revision --autogenerate -m "description"

# æ‰§è¡Œè¿ç§»
poetry run alembic upgrade head

# å›æ»šè¿ç§»
poetry run alembic downgrade -1
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v0.1.0 (å½“å‰ç‰ˆæœ¬)

- âœ… åŸºç¡€è®¤è¯åŠŸèƒ½ï¼ˆå¯†ç ã€OTPã€äºŒç»´ç ï¼‰
- âœ… ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ
- âœ… RBAC æƒé™ç®¡ç†
- âœ… å¤šç§Ÿæˆ·æ”¯æŒ
- âœ… å®¡è®¡æ—¥å¿—
- âœ… Docker éƒ¨ç½²æ”¯æŒ
- âœ… å®Œæ•´çš„æµ‹è¯•è¦†ç›–

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ†˜ æ”¯æŒä¸å¸®åŠ©

- ğŸ“– [éƒ¨ç½²æ–‡æ¡£](DEPLOYMENT.md)
- ğŸ› [æäº¤ Issue](https://github.com/your-repo/issues)
- ğŸ’¬ [è®¨è®ºåŒº](https://github.com/your-repo/discussions)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [FastAPI](https://fastapi.tiangolo.com/)
- [React](https://reactjs.org/)
- [SQLModel](https://sqlmodel.tiangolo.com/)
- [TailwindCSS](https://tailwindcss.com/)
- [Radix UI](https://www.radix-ui.com/)

---

<div align="center">
Made with â¤ï¸ by Authing Team
</div>
